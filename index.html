<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leave Assistant - HR Compliance Tool</title>
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon.svg">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon.svg">
    <link rel="apple-touch-icon" href="favicon.svg">
    
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://js.puter.com/v2/"></script>
</head>
<body>
    <div id="loading" class="loading-overlay hidden">
        <div class="spinner"></div>
        <p>Processing...</p>
    </div>

    <div id="loginPage" class="page">
        <div class="auth-container">
            <div class="logo-area">
                <div class="app-logo">
                    <img id="mainLogo" src="hrla-logo-full.png" alt="HRLA - HR Leave Compliance & Response Tool" class="logo-image">
                </div>
            </div>
            <div class="card">
                <h2>Sign In</h2>
                <form id="loginForm">
                    <div class="form-group">
                        <label>Email Address</label>
                        <input type="email" id="loginEmail" required placeholder="hr@company.com">
                    </div>
                    <div class="form-group">
                        <label>Password</label>
                        <input type="password" id="loginPassword" required>
                    </div>
                    <button type="submit" class="btn btn-primary btn-block">Login</button>
                    <div class="auth-links">
                        <a href="#" id="showRegister">Create new account</a>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div id="registerPage" class="page hidden">
        <div class="auth-container">
            <div class="card">
                <h2>Create Account</h2>
                <p class="trial-text">‚ú® Includes 24-Hour Free Premium Trial!</p>
                <form id="registerForm">
                    <div class="row">
                        <div class="form-group half">
                            <label>First Name</label>
                            <input type="text" id="firstName" required>
                        </div>
                        <div class="form-group half">
                            <label>Last Name</label>
                            <input type="text" id="lastName" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Work Email</label>
                        <input type="email" id="registerEmail" required placeholder="name@company.com">
                        <small class="hint">Disposable emails are not accepted.</small>
                    </div>
                    <div class="form-group">
                        <label>Password</label>
                        <input type="password" id="registerPassword" required>
                    </div>
                    <div class="form-group">
                        <label>Confirm Password</label>
                        <input type="password" id="confirmPassword" required>
                    </div>
                    <div class="form-check">
                        <input type="checkbox" id="termsAccepted" required>
                        <label for="termsAccepted">I agree to the Terms of Service</label>
                    </div>
                    <button type="submit" class="btn btn-primary btn-block">Register</button>
                    <div class="auth-links">
                        <a href="#" id="showLogin">Already have an account? Login</a>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div id="verificationPage" class="page hidden">
        <div class="auth-container">
            <div class="card text-center">
                <div class="app-logo">
                    <img src="hrla-logo-full.png" alt="HRLA - HR Leave Compliance & Response Tool" class="logo-image">
                </div>
                <i class="fa-solid fa-envelope-open-text fa-3x text-primary"></i>
                <h2>Verify Email</h2>
                <p><strong>Important:</strong> Please verify your email to complete registration.</p>
                <p>We've sent a verification link to your email address.</p>
                <p>Please check your inbox (and spam folder) to complete registration.</p>
                
                <!-- Verification Link Display - Only shown if email delivery fails -->
                <div id="verificationLinkSection" class="verification-link-section hidden">
                    <div class="alert alert-warning">
                        <h4><i class="fa-solid fa-exclamation-triangle"></i> Email Delivery Issue</h4>
                        <p><strong>We couldn't send the email automatically. Please use the link below:</strong></p>
                        <div class="verification-link-container">
                            <a id="verificationLinkButton" href="#" class="btn btn-primary" target="_blank">
                                <i class="fa-solid fa-check-circle"></i> Verify Email Now
                            </a>
                        </div>
                        <div class="verification-link-copy">
                            <input type="text" id="verificationLinkInput" readonly class="form-control">
                            <button id="copyVerificationLink" class="btn btn-secondary">
                                <i class="fa-solid fa-copy"></i> Copy Link
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="verification-actions">
                    <button id="resendVerification" class="btn btn-secondary">üìß Resend Email</button>
                    <button id="backToLogin" class="btn btn-text">‚Üê Back to Login</button>
                </div>
            </div>
        </div>
    </div>

    <div id="dashboard" class="page hidden">
        <nav class="navbar">
            <div class="nav-brand">
                <img src="hrla-logo.svg" alt="HRLA" class="nav-logo">
                <span class="nav-title">Leave Assistant</span>
            </div>
            <div class="nav-menu">
                <div id="trialTimer" class="trial-badge hidden">Trial Active: 23h remaining</div>
                <button id="settingsBtn" class="btn btn-text"><i class="fa-solid fa-gear"></i> Settings</button>
                <button id="logoutBtn" class="btn btn-text">Logout</button>
            </div>
        </nav>
        <div class="container">
            <div class="welcome-banner">
                <h2>Welcome, <span id="userWelcomeName">User</span></h2>
                <p>Select a compliance tool to begin</p>
            </div>
            <div class="tools-grid">
                <div class="tool-card" id="federalTool">
                    <div class="icon-box federal">
                        <i class="fa-solid fa-flag-usa"></i>
                    </div>
                    <h3>Federal FMLA</h3>
                    <p>Generate compliant responses for Federal Family & Medical Leave Act inquiries.</p>
                </div>
                <div class="tool-card" id="californiaTool">
                    <div class="icon-box california">
                        <i class="fa-solid fa-sun"></i>
                    </div>
                    <h3>California Leaves</h3>
                    <p>Navigate CFRA, PDL, and FMLA interactions specifically for California employees.</p>
                </div>
            </div>
        </div>
    </div>

    <div id="federalPage" class="page hidden">
        <nav class="navbar">
            <div class="nav-brand">
                <button id="backToDashboard1" class="btn btn-icon"><i class="fa-solid fa-arrow-left"></i></button>
                <img src="hrla-logo.svg" alt="HRLA" class="nav-logo">
                <span class="nav-title">Federal FMLA Assistant</span>
            </div>
            <div class="nav-menu">
                <button id="settingsBtn2" class="btn btn-text"><i class="fa-solid fa-gear"></i> Settings</button>
            </div>
        </nav>
        <div class="tool-container">
            <div class="mode-selector">
                <button class="mode-btn active" id="federalEmailMode">üìß Email Response</button>
                <button class="mode-btn" id="federalQuestionMode">‚ùì Quick Question</button>
            </div>
            <div class="split-view">
                <div class="input-section">
                    <label id="federalInputLabel">Paste Employee Email:</label>
                    <textarea id="federalInput" placeholder="Paste text here..."></textarea>
                    <div class="action-bar">
                        <button id="federalClear" class="btn btn-text">Clear</button>
                        <button id="federalSubmit" class="btn btn-primary">Generate Response <i class="fa-solid fa-wand-magic-sparkles"></i></button>
                    </div>
                </div>
                <div class="output-section">
                    <div class="output-header">
                        <label>AI Response:</label>
                        <button id="federalCopy" class="btn btn-sm btn-secondary"><i class="fa-regular fa-copy"></i> Copy</button>
                    </div>
                    <div id="federalOutput" class="response-box"></div>
                </div>
            </div>
        </div>
    </div>

    <div id="californiaPage" class="page hidden">
        <nav class="navbar">
            <div class="nav-brand">
                <button id="backToDashboard2" class="btn btn-icon"><i class="fa-solid fa-arrow-left"></i></button>
                <img src="hrla-logo.svg" alt="HRLA" class="nav-logo">
                <span class="nav-title">California Compliance</span>
            </div>
            <div class="nav-menu">
                <button id="settingsBtn3" class="btn btn-text"><i class="fa-solid fa-gear"></i> Settings</button>
            </div>
        </nav>
        <div class="tool-container">
            <div class="mode-selector">
                <button class="mode-btn active" id="californiaEmailMode">üìß Email Response</button>
                <button class="mode-btn" id="californiaQuestionMode">‚ùì Quick Question</button>
            </div>
            <div class="split-view">
                <div class="input-section">
                    <label id="californiaInputLabel">Paste Employee Email:</label>
                    <textarea id="californiaInput" placeholder="Paste text here..."></textarea>
                    <div class="action-bar">
                        <button id="californiaClear" class="btn btn-text">Clear</button>
                        <button id="californiaSubmit" class="btn btn-primary">Generate Response <i class="fa-solid fa-wand-magic-sparkles"></i></button>
                    </div>
                </div>
                <div class="output-section">
                    <div class="output-header">
                        <label>AI Response:</label>
                        <button id="californiaCopy" class="btn btn-sm btn-secondary"><i class="fa-regular fa-copy"></i> Copy</button>
                    </div>
                    <div id="californiaOutput" class="response-box"></div>
                </div>
            </div>
        </div>
    </div>

    <div id="subscriptionPage" class="page hidden">
        <div class="auth-container subscription-container">
            <div class="card text-center">
                <div class="app-logo">
                    <img src="hrla-logo-full.png" alt="HRLA - HR Leave Compliance & Response Tool" class="logo-image">
                </div>
                <i class="fa-solid fa-crown fa-3x text-warning"></i>
                <h2>Subscription Required</h2>
                <p>Your 24-hour free trial has ended.</p>
                <p>Please subscribe to continue using Leave Assistant.</p>
                
                <div class="price-box">
                    <span class="currency">$</span>
                    <span id="displayMonthlyFee" class="amount">29.99</span>
                    <span class="period">/month</span>
                </div>

                <div class="payment-methods">
                    <button id="payStripe" class="btn btn-stripe btn-block">
                        <i class="fa-brands fa-stripe"></i> Pay with Card (Stripe)
                    </button>
                    <button id="payPaypal" class="btn btn-paypal btn-block">
                        <i class="fa-brands fa-paypal"></i> Pay with PayPal
                    </button>
                </div>
                
                <div class="payment-info">
                    <p><small>‚úÖ Secure payment processing</small></p>
                    <p><small>üîÑ Cancel anytime</small></p>
                    <p><small>üìß Email support included</small></p>
                </div>
                
                <div class="subscription-actions">
                    <button id="backToHomepage" class="btn btn-secondary">‚Üê Logout & Return to Login</button>
                    <button id="subLogoutBtn" class="btn btn-text">Logout</button>
                </div>
            </div>
        </div>
    </div>

    <div id="paymentSuccessPage" class="page hidden">
        <div class="auth-container">
            <div class="card text-center">
                <div class="app-logo">
                    <img src="hrla-logo-full.png" alt="HRLA - HR Leave Compliance & Response Tool" class="logo-image">
                </div>
                <i class="fa-solid fa-check-circle fa-3x text-success"></i>
                <h2>Payment Successful!</h2>
                <p>Thank you for subscribing to Leave Assistant.</p>
                <p>Your subscription is now active and you have full access to all features.</p>
                
                <div class="success-actions">
                    <button id="continueToApp" class="btn btn-primary btn-block">Continue to App</button>
                </div>
            </div>
        </div>
    </div>

    <div id="paymentCancelledPage" class="page hidden">
        <div class="auth-container">
            <div class="card text-center">
                <div class="app-logo">
                    <img src="hrla-logo-full.png" alt="HRLA - HR Leave Compliance & Response Tool" class="logo-image">
                </div>
                <i class="fa-solid fa-times-circle fa-3x text-danger"></i>
                <h2>Payment Cancelled</h2>
                <p>Your payment was cancelled. No charges were made.</p>
                <p>You can try again or contact support if you need assistance.</p>
                
                <div class="cancel-actions">
                    <button id="retryPayment" class="btn btn-primary">Try Again</button>
                    <button id="backToDashboardFromCancel" class="btn btn-text">Back to Dashboard</button>
                </div>
            </div>
        </div>
    </div>

    <div id="settingsModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>User Settings</h3>
                <button id="closeSettings" class="btn-close">&times;</button>
            </div>
            <div class="modal-body">
                <form id="settingsForm">
                    <div class="form-group">
                        <label>AI Provider Selection</label>
                        <select id="aiProvider" class="form-control">
                            <option value="puter">Puter.js AI (Free - Default)</option>
                            <option value="openai">OpenAI GPT (Requires Key)</option>
                            <option value="gemini">Google Gemini (Requires Key)</option>
                            <option value="demo">Demo Mode (Mock Data)</option>
                        </select>
                    </div>

                    <div id="openaiKeySection" class="api-key-section hidden">
                        <div class="form-group">
                            <label>OpenAI API Key</label>
                            <input type="password" id="openaiApiKey" placeholder="sk-...">
                            <small>Required for OpenAI GPT models.</small>
                        </div>
                    </div>

                    <div id="geminiKeySection" class="api-key-section hidden">
                        <div class="form-group">
                            <label>Google Gemini API Key</label>
                            <input type="password" id="geminiApiKey" placeholder="AIza...">
                            <small>Get free API key from Google AI Studio.</small>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Change Password</label>
                        <input type="password" id="newPassword" placeholder="New Password (optional)">
                    </div>
                    <button type="submit" class="btn btn-primary">Save Settings</button>
                </form>
            </div>
        </div>
    </div>

    <div id="adminProfilePage" class="page hidden">
        <nav class="navbar admin-nav">
            <div class="nav-brand">
                <button id="backToAdminDashboard" class="btn btn-icon"><i class="fa-solid fa-arrow-left"></i></button>
                <img src="hrla-logo.svg" alt="HRLA" class="nav-logo">
                <span class="nav-title">Admin Profile</span>
            </div>
            <div class="nav-menu">
                <button id="adminLogoutBtn2" class="btn btn-text">Logout</button>
            </div>
        </nav>
        <div class="container">
            <div class="profile-container">
                <div class="profile-header">
                    <div class="profile-avatar">
                        <i class="fa-solid fa-user-shield fa-3x"></i>
                    </div>
                    <h2>Administrator Profile</h2>
                </div>
                
                <div class="profile-form-container">
                    <form id="adminProfileForm">
                        <div class="form-section">
                            <h3>Personal Information</h3>
                            <div class="row">
                                <div class="form-group half">
                                    <label>First Name</label>
                                    <input type="text" id="adminFirstName" required>
                                </div>
                                <div class="form-group half">
                                    <label>Last Name</label>
                                    <input type="text" id="adminLastName" required>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Email Address</label>
                                <input type="email" id="adminEmail" required>
                            </div>
                        </div>
                        
                        <div class="form-section">
                            <h3>Security</h3>
                            <div class="form-group">
                                <label>Current Password</label>
                                <input type="password" id="adminCurrentPassword" placeholder="Enter current password to make changes">
                            </div>
                            <div class="form-group">
                                <label>New Password</label>
                                <input type="password" id="adminNewPassword" placeholder="Leave blank to keep current password">
                            </div>
                            <div class="form-group">
                                <label>Confirm New Password</label>
                                <input type="password" id="adminConfirmPassword" placeholder="Confirm new password">
                            </div>
                        </div>
                        
                        <div class="form-section">
                            <h3>Account Information</h3>
                            <div class="info-grid">
                                <div class="info-item">
                                    <label>Account Type</label>
                                    <span class="info-value">Administrator</span>
                                </div>
                                <div class="info-item">
                                    <label>Account Created</label>
                                    <span class="info-value" id="adminCreatedDate">-</span>
                                </div>
                                <div class="info-item">
                                    <label>Last Login</label>
                                    <span class="info-value" id="adminLastLogin">Current Session</span>
                                </div>
                                <div class="info-item">
                                    <label>User ID</label>
                                    <span class="info-value" id="adminUserId">-</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary">
                                <i class="fa-solid fa-save"></i> Save Changes
                            </button>
                            <button type="button" id="cancelProfileChanges" class="btn btn-secondary">
                                <i class="fa-solid fa-times"></i> Cancel
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <div id="adminDashboard" class="page hidden">
        <nav class="navbar admin-nav">
            <div class="nav-brand">
                <img src="hrla-logo.svg" alt="HRLA" class="nav-logo">
                <span class="nav-title">Admin Console</span>
            </div>
            <div class="nav-menu">
                <button id="adminSettingsBtn" class="btn btn-text"><i class="fa-solid fa-user-shield"></i> Profile</button>
                <button id="adminLogoutBtn" class="btn btn-text">Logout</button>
            </div>
        </nav>
        <div class="container">
            <div class="admin-stats">
                <div class="stat-card clickable-card" data-filter="all" title="Click to view all users">
                    <h3>Total Users</h3>
                    <p id="totalUsers">0</p>
                </div>
                <div class="stat-card clickable-card" data-filter="verified" title="Click to view verified users">
                    <h3>Verified</h3>
                    <p id="verifiedUsers">0</p>
                </div>
                <div class="stat-card clickable-card" data-filter="pending" title="Click to view pending verifications">
                    <h3>Pending</h3>
                    <p id="pendingVerifications">0</p>
                </div>
                <div class="stat-card clickable-card" data-filter="active" title="Click to view users with active subscriptions">
                    <h3>Active Subs</h3>
                    <p id="activeSubscriptions">0</p>
                </div>
                <div class="stat-card clickable-card" data-filter="trial" title="Click to view users in trial">
                    <h3>In Trial</h3>
                    <p id="trialUsers">0</p>
                </div>
            </div>

            <div class="admin-tabs">
                <button class="tab-btn active" data-tab="users">User Management</button>
                <button class="tab-btn" data-tab="payments">Payment Settings</button>
                <button class="tab-btn" data-tab="email">Email Settings</button>
                <button class="tab-btn" data-tab="system">System Config</button>
            </div>

            <div id="usersTab" class="tab-content">
                <div class="toolbar">
                    <input type="text" id="userSearch" placeholder="Search users...">
                    <select id="userFilter">
                        <option value="all">All Users</option>
                        <option value="verified">Verified</option>
                        <option value="active">Active Access</option>
                        <option value="expired">Expired/No Access</option>
                    </select>
                    <div class="bulk-actions">
                        <button id="bulkGrantBtn" class="btn btn-success"><i class="fa-solid fa-key"></i> Bulk Grant Access</button>
                    </div>
                    <button id="refreshUsers" class="btn btn-secondary"><i class="fa-solid fa-sync"></i></button>
                    <button id="exportUsers" class="btn btn-secondary"><i class="fa-solid fa-download"></i> CSV</button>
                </div>
                
                <div class="table-container">
                    <table class="data-table" id="usersTable">
                        <thead>
                            <tr>
                                <th><input type="checkbox" id="selectAllUsers"></th>
                                <th>User</th>
                                <th>Status</th>
                                <th>Trial/Sub</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="usersListTableBody">
                            </tbody>
                    </table>
                </div>

                <h3 class="mt-4">Pending Verifications</h3>
                <div id="pendingList" class="pending-grid"></div>
            </div>

            <div id="paymentsTab" class="tab-content hidden">
                <div class="card settings-card">
                    <h3>Payment Configuration</h3>
                    <p class="text-muted">Configure how users pay for the service after the 24-hour trial.</p>
                    <form id="paymentSettingsForm">
                        <div class="form-group">
                            <label>Monthly Subscription Fee ($)</label>
                            <input type="number" id="adminMonthlyFee" step="0.01" min="0" required>
                        </div>
                        <div class="form-group">
                            <label>PayPal Client ID</label>
                            <input type="text" id="adminPaypalClientId" placeholder="PayPal Client ID">
                            <small>Get from PayPal Developer Dashboard</small>
                        </div>
                        <div class="form-group">
                            <label>PayPal Client Secret</label>
                            <input type="password" id="adminPaypalClientSecret" placeholder="PayPal Client Secret">
                        </div>
                        <div class="form-group">
                            <label>Stripe Secret Key</label>
                            <input type="password" id="adminStripeSecretKey" placeholder="sk_test_... or sk_live_...">
                            <small>Get from Stripe Dashboard</small>
                        </div>
                        <div class="form-group">
                            <label>Stripe Webhook Secret</label>
                            <input type="password" id="adminStripeWebhookSecret" placeholder="whsec_...">
                            <small>For webhook signature verification</small>
                        </div>
                        <div class="form-group">
                            <label>System Free API Key (Gemini)</label>
                            <input type="password" id="adminSystemGeminiKey" placeholder="Leave blank to disable system-wide free tier">
                            <small>If set, users can use "Google Gemini" without providing their own key.</small>
                        </div>
                        <button type="submit" class="btn btn-primary">Save Payment Settings</button>
                    </form>
                </div>
            </div>

            <div id="emailTab" class="tab-content hidden">
                <div class="card settings-card">
                    <h3>Email Configuration</h3>
                    <p class="text-muted">Configure SMTP settings to send confirmation emails automatically.</p>
                    
                    <div id="emailStatus" class="status-indicator">
                        <span class="status-dot status-error"></span>
                        <span>Email service not configured</span>
                    </div>
                    
                    <form id="emailSettingsForm">
                        <div class="form-group">
                            <label>Email Address</label>
                            <input type="email" id="smtpEmail" placeholder="your-email@gmail.com" required>
                            <small>The email address that will send confirmation emails</small>
                        </div>
                        <div class="form-group">
                            <label>App Password</label>
                            <input type="password" id="smtpPassword" placeholder="16-character app password" required>
                            <small>Generate this from your email provider's security settings</small>
                        </div>
                        <div class="form-group">
                            <label>Email Provider</label>
                            <select id="smtpProvider" required>
                                <option value="gmail">Gmail</option>
                                <option value="outlook">Outlook/Hotmail</option>
                                <option value="yahoo">Yahoo Mail</option>
                                <option value="custom">Custom SMTP</option>
                            </select>
                        </div>
                        <div id="customSmtpSettings" class="hidden">
                            <div class="form-group">
                                <label>SMTP Host</label>
                                <input type="text" id="smtpHost" placeholder="smtp.example.com">
                            </div>
                            <div class="form-group">
                                <label>SMTP Port</label>
                                <input type="number" id="smtpPort" placeholder="587" value="587">
                            </div>
                        </div>
                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary">Save & Test Email Settings</button>
                            <button type="button" id="testEmailBtn" class="btn btn-secondary">Send Test Email</button>
                        </div>
                    </form>
                    
                    <div class="email-help">
                        <h4>Setup Instructions:</h4>
                        <div class="help-section">
                            <strong>Gmail:</strong>
                            <ol>
                                <li>Enable 2-factor authentication</li>
                                <li>Go to Google Account ‚Üí Security ‚Üí App passwords</li>
                                <li>Generate app password for "Mail"</li>
                                <li>Use the 16-character password above</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </div>

            <div id="systemTab" class="tab-content hidden">
                <div class="card settings-card">
                    <h3>System Settings</h3>
                    <div class="setting-row">
                        <label>Allow New Registrations</label>
                        <input type="checkbox" id="allowRegistration" checked>
                    </div>
                    <div class="setting-row">
                        <label>Require Email Verification</label>
                        <input type="checkbox" id="requireEmailVerification" checked>
                    </div>
                    <hr>
                    <div class="setting-row danger-zone">
                        <label>Clear All Data</label>
                        <button id="clearAllData" class="btn btn-danger">Reset System</button>
                    </div>
                    <p class="stats-text">Local Storage Usage: <span id="storageUsed">0 KB</span></p>
                </div>
            </div>
        </div>
    </div>

    <!-- User Details Modal -->
    <div id="userDetailsModal" class="modal hidden">
        <div class="modal-content large-modal">
            <div class="modal-header">
                <h3 id="userDetailsTitle">User Details</h3>
                <button id="closeUserDetails" class="btn-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="user-profile-section">
                    <div class="user-avatar">
                        <i class="fa-solid fa-user-circle fa-4x text-primary"></i>
                    </div>
                    <div class="user-basic-info">
                        <h2 id="userFullName">Loading...</h2>
                        <p id="userEmail" class="text-muted">Loading...</p>
                        <div id="userStatus" class="status-badge">Loading...</div>
                    </div>
                </div>
                
                <div class="user-details-grid">
                    <div class="detail-card">
                        <h4><i class="fa-solid fa-info-circle"></i> Account Information</h4>
                        <div class="detail-row">
                            <span class="label">User ID:</span>
                            <span id="userDetailId">-</span>
                        </div>
                        <div class="detail-row">
                            <span class="label">Email Verified:</span>
                            <span id="userDetailVerified">-</span>
                        </div>
                        <div class="detail-row">
                            <span class="label">Registration Date:</span>
                            <span id="userDetailCreated">-</span>
                        </div>
                        <div class="detail-row">
                            <span class="label">AI Provider:</span>
                            <span id="userDetailProvider">-</span>
                        </div>
                    </div>
                    
                    <div class="detail-card">
                        <h4><i class="fa-solid fa-crown"></i> Subscription Status</h4>
                        <div class="detail-row">
                            <span class="label">Current Status:</span>
                            <span id="userDetailStatus">-</span>
                        </div>
                        <div class="detail-row">
                            <span class="label">Trial Period:</span>
                            <span id="userDetailTrial">-</span>
                        </div>
                        <div class="detail-row">
                            <span class="label">Subscription Expiry:</span>
                            <span id="userDetailExpiry">-</span>
                        </div>
                        <div class="detail-row">
                            <span class="label">Access Level:</span>
                            <span id="userDetailAccess">-</span>
                        </div>
                    </div>
                    
                    <div class="detail-card">
                        <h4><i class="fa-solid fa-chart-line"></i> Usage Statistics</h4>
                        <div class="detail-row">
                            <span class="label">Total Conversations:</span>
                            <span id="userDetailConversations">-</span>
                        </div>
                        <div class="detail-row">
                            <span class="label">Last Login:</span>
                            <span id="userDetailLastLogin">-</span>
                        </div>
                        <div class="detail-row">
                            <span class="label">API Keys Set:</span>
                            <span id="userDetailApiKeys">-</span>
                        </div>
                        <div class="detail-row">
                            <span class="label">Account Type:</span>
                            <span id="userDetailType">-</span>
                        </div>
                    </div>
                </div>
                
                <div class="user-actions-section">
                    <h4>Admin Actions</h4>
                    <div class="action-buttons">
                        <button id="backToUserList" class="btn btn-secondary">
                            <i class="fa-solid fa-arrow-left"></i> Back to User List
                        </button>
                        <button id="grantUserAccess" class="btn btn-success">
                            <i class="fa-solid fa-key"></i> Grant Access
                        </button>
                        <button id="editUserProfile" class="btn btn-primary">
                            <i class="fa-solid fa-edit"></i> Edit Profile
                        </button>
                        <button id="viewUserConversations" class="btn btn-info">
                            <i class="fa-solid fa-comments"></i> View Conversations
                        </button>
                        <button id="deleteUserAccount" class="btn btn-danger">
                            <i class="fa-solid fa-trash"></i> Delete Account
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Filtered Users Modal -->
    <div id="filteredUsersModal" class="modal hidden">
        <div class="modal-content large-modal">
            <div class="modal-header">
                <h3 id="filteredUsersTitle">Users</h3>
                <button id="closeFilteredUsers" class="btn-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="filtered-users-toolbar">
                    <div class="search-section">
                        <input type="text" id="filteredUserSearch" placeholder="Search users...">
                        <button id="refreshFilteredUsers" class="btn btn-secondary">
                            <i class="fa-solid fa-sync"></i> Refresh
                        </button>
                    </div>
                    <div class="bulk-actions-section">
                        <button id="selectAllFiltered" class="btn btn-outline">Select All</button>
                        <button id="bulkGrantFiltered" class="btn btn-success">
                            <i class="fa-solid fa-key"></i> Bulk Grant Access
                        </button>
                    </div>
                </div>
                
                <div class="filtered-users-list" id="filteredUsersList">
                    <!-- Users will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <div id="bulkGrantModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Grant Access</h3>
                <button id="closeBulkGrant" class="btn-close">&times;</button>
            </div>
            <div class="modal-body">
                <p>Grant access to <span id="bulkCount">0</span> selected users.</p>
                <form id="bulkGrantForm">
                    <div class="form-group">
                        <label>Duration</label>
                        <select id="grantDuration" class="form-control">
                            <option value="1">1 Month</option>
                            <option value="3">3 Months</option>
                            <option value="6">6 Months</option>
                            <option value="12">1 Year</option>
                            <option value="forever">Lifetime</option>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-success btn-block">Grant Access</button>
                </form>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    <script>
        // Initialize EmailJS for Netlify deployment
        // You'll need to replace these with your actual EmailJS credentials
        const EMAILJS_CONFIG = {
            publicKey: 'YOUR_EMAILJS_PUBLIC_KEY', // Replace with your EmailJS public key
            serviceId: 'YOUR_SERVICE_ID', // Replace with your EmailJS service ID
            templateId: 'YOUR_TEMPLATE_ID' // Replace with your EmailJS template ID
        };
        
        // Initialize EmailJS
        if (typeof emailjs !== 'undefined') {
            emailjs.init(EMAILJS_CONFIG.publicKey);
        }
        
        // Function to send verification email via EmailJS
        window.sendVerificationEmail = function(to, firstName, verificationLink) {
            if (typeof emailjs === 'undefined') {
                console.warn('EmailJS not loaded, showing verification link directly');
                return Promise.resolve({ success: true, method: 'direct' });
            }
            
            const templateParams = {
                to_email: to,
                to_name: firstName,
                verification_link: verificationLink,
                from_name: 'HRLA Leave Assistant'
            };
            
            return emailjs.send(EMAILJS_CONFIG.serviceId, EMAILJS_CONFIG.templateId, templateParams)
                .then(function(response) {
                    console.log('‚úÖ Email sent successfully via EmailJS', response);
                    return { success: true, method: 'emailjs' };
                })
                .catch(function(error) {
                    console.warn('‚ö†Ô∏è EmailJS failed, showing verification link directly', error);
                    return { success: true, method: 'direct' };
                });
        };
        
        // Simple logo loading
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üñºÔ∏è Page loaded, checking logo...');
            const logo = document.getElementById('mainLogo');
            if (logo) {
                logo.onload = function() {
                    console.log('‚úÖ Logo loaded successfully from:', this.src);
                };
                
                logo.onerror = function() {
                    console.error('‚ùå Logo failed to load from:', this.src);
                    console.log('üîÑ Trying fallback logo...');
                    // Try the SVG version as fallback
                    this.src = 'logo.svg';
                };
            }
        });
    </script>
    <script src="app.js"></script>
</body>
</html>